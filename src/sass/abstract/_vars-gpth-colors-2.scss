:root {
    /* Base accent color definition */
    --accent-h: 335;
    --accent-s: 21%;
    --accent-l: 35%;
    --accent-hsl: var(--accent-h) var(--accent-s) var(--accent-l);

    /* Color space definition */
    color-scheme: light dark;
    color: color(display-p3 0 0 0);

    --mix: color-mix;
    --oklab: in oklab;
    --srgb: in srgb;
    --hsl: in hsl;
}

/* Utility functions for color manipulation */
// @supports (color: color-mix(in oklab, black, black)) {
//     :root {
//         --mix: color-mix;
//         --oklab: in oklab;
//         --srgb: in srgb;
//         --hsl: in hsl;
//     }
// }

/* Light theme - uses advanced color functions */
html.light {
    /* Base colors derived from accent */
    --txt-hsl: var(--accent-h) 0% 0%;
    --surface-h: var(--accent-h);
    --surface-s: 9%;
    --surface-l: 90%;

    /* Semantic colors using color-mix */
    --c-txt: hsl(var(--txt-hsl));
    --c-danger: color-mix(var(--srgb), hsl(354 63% 48%) 100%, var(--c-accent) 20%);
    --c-warning: color-mix(var(--srgb), hsl(27 88% 44%) 100%, var(--c-accent) 15%);
    --c-success: color-mix(var(--srgb), hsl(162 92% 25%) 100%, var(--c-accent) 10%);
    --c-accent: hsl(var(--accent-hsl));

    /* Surface colors with automatic contrast */
    --c-surface-1: hsl(var(--surface-h) var(--surface-s) var(--surface-l));
    --c-surface-2: color-mix(var(--hsl), var(--c-surface-1) 90%, black 10%);
    --c-surface-3: color-mix(var(--hsl), var(--c-surface-1) 85%, black 15%);

    /* Derived colors with transparency */
    --c-accent-light: color-mix(var(--hsl), var(--c-accent) 30%, white 70%);
    --c-on-accent: color-contrast(var(--c-accent) vs white, black);

    /* Text variants */
    --c-subtext-1: color-mix(var(--srgb), var(--c-txt) 80%, transparent);
    --c-subtext-2: color-mix(var(--srgb), var(--c-txt) 60%, transparent);

    /* Component colors */
    --c-bg-sidebar: var(--c-surface-1);
    --c-bg-textarea: linear-gradient(145deg,
            color-mix(var(--srgb), var(--c-accent) 20%, transparent) 0%,
            color-mix(var(--srgb), var(--c-accent) 10%, transparent) 22%,
            color-mix(var(--srgb), var(--c-accent) 10%, transparent) 68%,
            color-mix(var(--srgb), var(--c-accent) 20%, transparent) 100%);

    --c-scrollbar-thumb: var(--c-surface-3);
    --c-scrollbar-track: transparent;
    --c-bg-cm: var(--c-surface-1);
    --c-bg-tooltip: var(--c-accent-light);
    --c-border-accent: color-mix(var(--srgb), var(--c-accent) 10%, transparent);

    --box-shadow: var(--box-shadow-values) color-mix(var(--srgb), var(--c-accent) 10%, transparent);

    --c-bg-gradient: linear-gradient(135deg,
            color-mix(var(--srgb), var(--c-accent) 45%, transparent) 0%,
            color-mix(var(--srgb), var(--c-accent) 10%, transparent) 40%,
            color-mix(var(--srgb), var(--c-accent) 5%, transparent) 60%,
            color-mix(var(--srgb), var(--c-accent) 45%, transparent) 100%);

    --c-bg-chats-container: color-mix(var(--hsl), var(--c-surface-1) 98%, white 2%);
    --c-bg-msg-user: color-mix(var(--srgb), var(--c-accent) 8%, transparent);
    --c-bg-msg-gpt: color-mix(var(--hsl), var(--c-surface-1) 97%, white 3%);
    --c-bg-modal: color-mix(var(--srgb), var(--c-txt) 30%, transparent);
    --c-bg-dialog: var(--c-surface-2);
    --c-bg-menu: color-mix(var(--srgb), var(--c-accent-light) 50%, transparent);
    --brightness-menu: brightness(0.98);
    --c-border: color-mix(var(--srgb), var(--c-txt) 8%, transparent);
}

/* Dark theme - automatically adapts from light theme */
html.dark {
    /* Invert and adjust base colors */
    --txt-hsl: var(--accent-h) 86% 94%;
    --surface-h: var(--accent-h);
    --surface-s: 19%;
    --surface-l: 13%;

    /* Semantic colors with dark mode adjustments */
    --c-txt: hsl(var(--txt-hsl));
    --c-danger: color-mix(var(--srgb), hsl(356 77% 76%) 100%, var(--c-accent) 15%);
    --c-warning: color-mix(var(--srgb), hsl(30 100% 74%) 100%, var(--c-accent) 10%);
    --c-success: color-mix(var(--srgb), hsl(162 92% 64%) 100%, var(--c-accent) 5%);
    --c-accent: hsl(var(--accent-h) 100% 83%);

    /* Surface colors for dark mode */
    --c-surface-1: hsl(var(--surface-h) var(--surface-s) var(--surface-l));
    --c-surface-2: color-mix(var(--hsl), var(--c-surface-1) 85%, white 15%);
    --c-surface-3: color-mix(var(--hsl), var(--c-surface-1) 70%, white 30%);

    /* Derived colors */
    --c-accent-light: color-mix(var(--hsl), var(--c-accent) 130%, white -30%);
    --c-on-accent: color-contrast(var(--c-accent) vs white, black);

    /* Text variants */
    --c-subtext-1: var(--c-accent-light);
    --c-subtext-2: color-mix(var(--hsl), var(--c-accent) 50%, var(--c-surface-1) 50%);

    /* Component colors for dark mode */
    --c-bg-chats-container: color-mix(var(--hsl), var(--c-surface-1) 92%, white 8%);
    --c-bg-msg-user: color-mix(var(--srgb), var(--c-accent) 20%, transparent);
    --c-bg-msg-gpt: color-mix(var(--srgb), var(--c-accent) 8%, transparent);
    --c-bg-modal: color-mix(var(--srgb), var(--c-accent) 15%, transparent);
    --c-bg-menu: color-mix(var(--srgb), var(--c-accent-light) 30%, transparent);
    --brightness-menu: brightness(0.8);
}

/* OLED theme extension */
html.dark[data-gptheme='oled'] {
    --surface-s: 0%;
    --surface-l: 0%;

    --c-surface-1: hsl(var(--surface-h) var(--surface-s) var(--surface-l));
    --c-surface-2: color-mix(var(--hsl), var(--c-surface-1) 88%, white 12%);
    --c-surface-3: color-mix(var(--hsl), var(--c-surface-1) 92%, white 8%);

    --c-bg-chats-container: var(--c-surface-1);
    --c-bg-msg-gpt: color-mix(var(--hsl), var(--c-surface-1) 94%, white 6%);
    --c-bg-dialog: var(--c-surface-1);
}

/* Fallback for browsers without advanced color support */
// @supports not (color: color-mix(in oklab, black, black)) {

//     html.light,
//     html.dark {
//         --c-surface-2: hsl(var(--surface-h) var(--surface-s) calc(var(--surface-l) * 0.945));
//         --c-surface-3: hsl(var(--surface-h) var(--surface-s) calc(var(--surface-l) * 0.905));
//         /* Add other fallbacks as needed */
//     }
// }